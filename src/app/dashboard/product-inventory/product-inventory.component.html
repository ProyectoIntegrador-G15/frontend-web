<!-- Bot贸n de regreso -->
<div class="mb-6">
  <button
    (click)="goBack()"
    class="inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition-colors duration-200">
    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
    </svg>
    Regresar
  </button>
</div>

<!-- Resumen del inventario -->
<div class="bg-white dark:bg-white/10 m-0 p-0 text-theme-gray dark:text-white/60 text-[15px] rounded-10 relative mb-[25px]">
  <div class="p-[25px]">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
      <div class="bg-blue-50 dark:bg-blue-900/20 p-6 rounded-lg">
        <div class="flex items-center mb-3">
          <div class="w-10 h-10 bg-blue-100 dark:bg-blue-800 rounded-lg flex items-center justify-center mr-3">
            <svg class="w-5 h-5 text-blue-600 dark:text-blue-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00-.586 1.414l-1 1a2 2 0 01-1.414.586H9.414a2 2 0 01-1.414-.586l-1-1A2 2 0 006.172 10.172V5L5 4z"></path>
            </svg>
          </div>
          <h3 class="text-lg font-semibold text-blue-800 dark:text-blue-300">Medicamento</h3>
        </div>
        <p class="text-sm text-blue-700 dark:text-blue-200 mb-1">ID: {{ inventoryData?.product_id || 'N/A' }}</p>
        <p class="text-lg font-bold text-blue-900 dark:text-blue-100">{{ inventoryData?.product_name || 'N/A' }}</p>
      </div>

      <div class="bg-green-50 dark:bg-green-900/20 p-6 rounded-lg">
        <div class="flex items-center mb-3">
          <div class="w-10 h-10 bg-green-100 dark:bg-green-800 rounded-lg flex items-center justify-center mr-3">
            <svg class="w-5 h-5 text-green-600 dark:text-green-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
            </svg>
          </div>
          <h3 class="text-lg font-semibold text-green-800 dark:text-green-300">Bodegas</h3>
        </div>
        <p class="text-3xl font-bold text-green-900 dark:text-green-100">{{ inventoryData?.total_warehouses || 0 }}</p>
        <p class="text-sm text-green-700 dark:text-green-200">con inventario</p>
      </div>

      <div class="bg-purple-50 dark:bg-purple-900/20 p-6 rounded-lg">
        <div class="flex items-center mb-3">
          <div class="w-10 h-10 bg-purple-100 dark:bg-purple-800 rounded-lg flex items-center justify-center mr-3">
            <svg class="w-5 h-5 text-purple-600 dark:text-purple-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
            </svg>
          </div>
          <h3 class="text-lg font-semibold text-purple-800 dark:text-purple-300">Cantidad Total</h3>
        </div>
        <p class="text-3xl font-bold text-purple-900 dark:text-purple-100">{{ inventoryData?.total_quantity || 0 }}</p>
        <p class="text-sm text-purple-700 dark:text-purple-200">unidades disponibles</p>
      </div>
    </div>
  </div>
</div>

<!-- Tabla de inventario por bodega -->
<div *ngIf="!isLoading && warehousesData.length > 0 && !errorMessage" class="bg-white dark:bg-white/10 m-0 p-0 text-theme-gray dark:text-white/60 text-[15px] rounded-10 relative mb-[25px]">
  <div class="p-[25px]">
    <div class="w-full overflow-x-auto">
      <nz-table #warehousesTable [nzData]="warehousesData" [nzFrontPagination]="false" [nzShowPagination]="false">
        <thead>
        <tr>
          <th
            class="bg-regularBG dark:bg-[#323440] px-[20px] py-[16px] text-start text-dark dark:text-white/[.87] text-15px font-medium border-none before:hidden rounded-s-[10px] capitalize">
            Nombre de Bodega
          </th>
          <th
            class="bg-regularBG dark:bg-[#323440] px-2 py-[16px] text-start text-dark dark:text-white/[.87] text-[15px] font-medium border-none before:hidden capitalize">
            Ubicaci贸n
          </th>
          <th
            class="bg-regularBG dark:bg-[#323440] px-2 py-[16px] text-start text-dark dark:text-white/[.87] text-[15px] font-medium border-none before:hidden capitalize">
            Direcci贸n
          </th>
          <th
            class="bg-regularBG dark:bg-[#323440] px-2 py-[16px] text-start text-dark dark:text-white/[.87] text-[15px] font-medium border-none before:hidden capitalize">
            Sector
          </th>
          <th
            class="bg-regularBG dark:bg-[#323440] px-2 py-[16px] text-start text-dark dark:text-white/[.87] text-[15px] font-medium border-none before:hidden capitalize">
            Cantidad Disponible
          </th>
          <th
            class="bg-regularBG dark:bg-[#323440] px-2 py-[16px] text-start text-dark dark:text-white/[.87] text-[15px] font-medium border-none before:hidden capitalize">
            Estado
          </th>
        </tr>
        </thead>
        <tbody>
        <tr class="group" *ngFor="let warehouse of warehousesTable.data">
          <td
            class="ltr:pr-4 rtl:pl-4 text-dark dark:text-white/[.87] text-[15px] py-4 before:hidden border-none group-hover:bg-transparent">
            {{ warehouse.name }}
          </td>
          <td
            class="ltr:pr-4 rtl:pl-4 text-dark dark:text-white/[.87] text-[15px] py-4 before:hidden border-none group-hover:bg-transparent">
            {{ warehouse.city }}, {{ warehouse.country }}
          </td>
          <td
            class="ltr:pr-4 rtl:pl-4 text-dark dark:text-white/[.87] text-[15px] py-4 before:hidden border-none group-hover:bg-transparent">
            {{ warehouse.address }}
          </td>
          <td
            class="ltr:pr-4 rtl:pl-4 text-dark dark:text-white/[.87] text-[15px] py-4 before:hidden border-none group-hover:bg-transparent">
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300">
              {{ warehouse.location_identifier }}
            </span>
          </td>
          <td
            class="ltr:pr-4 rtl:pl-4 text-dark dark:text-white/[.87] text-[15px] py-4 before:hidden border-none group-hover:bg-transparent">
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300">
              {{ warehouse.available_quantity }} unidades
            </span>
          </td>
          <td
            class="ltr:pr-4 rtl:pl-4 text-dark dark:text-white/[.87] text-[15px] py-4 before:hidden border-none group-hover:bg-transparent">
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                  [ngClass]="getStatusClass(warehouse.status)">
              {{ getStatusText(warehouse.status) }}
            </span>
          </td>
        </tr>
        </tbody>
      </nz-table>
    </div>
  </div>
</div>

<!-- Mensaje cuando no hay datos -->
<div *ngIf="!isLoading && !errorMessage && warehousesData.length === 0" class="bg-white dark:bg-white/10 m-0 p-0 text-theme-gray dark:text-white/60 text-[15px] rounded-10 relative mb-[25px]">
  <div class="p-[25px]">
    <div class="flex flex-col items-center justify-center py-16">
      <div class="w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mb-4">
        <svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"></path>
        </svg>
      </div>
      <h3 class="text-lg font-semibold text-dark dark:text-white mb-2">No hay inventario disponible</h3>
      <p class="text-sm text-gray-600 dark:text-gray-400">Este producto no tiene inventario en ninguna bodega</p>
    </div>
  </div>
</div>

<!-- Mensaje de error -->
<div *ngIf="errorMessage" class="bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 mb-4">
  <div class="flex">
    <div class="flex-shrink-0">
      <svg class="h-5 w-5 text-red-400" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" />
      </svg>
    </div>
    <div class="ml-3">
      <h3 class="text-sm font-medium text-red-800 dark:text-red-300">
        Error
      </h3>
      <div class="mt-2 text-sm text-red-700 dark:text-red-400">
        {{ errorMessage }}
      </div>
    </div>
  </div>
</div>

<!-- Loading state -->
<div *ngIf="isLoading" class="bg-white dark:bg-white/10 m-0 p-0 text-theme-gray dark:text-white/60 text-[15px] rounded-10 relative mb-[25px]">
  <div class="p-[25px]">
    <div class="flex flex-col items-center justify-center py-16">
      <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary mb-4"></div>
      <h3 class="text-lg font-semibold text-dark dark:text-white mb-2">Cargando inventario...</h3>
      <p class="text-sm text-gray-600 dark:text-gray-400">Obteniendo informaci贸n de bodegas y productos</p>
    </div>
  </div>
</div>
