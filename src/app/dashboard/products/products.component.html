<!-- Modal de crear producto -->
<nz-modal
  [(nzVisible)]="isProductModalVisible"
  [nzTitle]="productModalTitle"
  [nzContent]="productModalContent"
  [nzFooter]="productModalFooter"
  (nzOnCancel)="handleProductModalCancel()"
  nzWidth="75%"
>
  <ng-template #productModalTitle>Nuevo Producto</ng-template>

  <ng-template #productModalContent>
    <form nz-form nzLayout="vertical" [formGroup]="validateForm" (ngSubmit)="handleProductModalOk()">
      <nz-form-item>
        <nz-form-control [nzValidateStatus]="getFieldStatus('name')" [nzErrorTip]="getFieldError('name')">
          <nz-form-label class="text-[15px] font-semibold text-dark dark:text-white/[.87] capitalize mb-[10px]">Nombre
            del producto: <span class="text-red-500">*</span></nz-form-label>
          <input class="{{inputClass}}" type="text" nz-input placeholder="Nombre del producto" formControlName="name">
        </nz-form-control>
      </nz-form-item>

      <div nz-row nzGutter="16">
        <div nz-col nzXs="24" nzSm="12">
          <nz-form-item>
            <nz-form-control [nzValidateStatus]="getFieldStatus('price')" [nzErrorTip]="getFieldError('price')">
              <nz-form-label class="text-[15px] font-semibold text-dark dark:text-white/[.87] capitalize mb-[10px]">
                Precio por unidad: <span class="text-red-500">*</span></nz-form-label>
              <input class="{{inputClass}}" type="number" nz-input placeholder="$##.### COP" formControlName="price">
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzXs="24" nzSm="12">
          <nz-form-item>
            <nz-form-control [nzValidateStatus]="getFieldStatus('supplier')" [nzErrorTip]="getFieldError('supplier')">
              <nz-form-label class="text-[15px] font-semibold text-dark dark:text-white/[.87] capitalize mb-[10px]">
                Proveedor: <span class="text-red-500">*</span></nz-form-label>
              <nz-select
                class="w-full"
                nzPlaceHolder="Seleccionar proveedor" nzAllowClear formControlName="supplier">
                <nz-option nzValue="proveedor1" nzLabel="Proveedor 1"></nz-option>
                <nz-option nzValue="proveedor2" nzLabel="Proveedor 2"></nz-option>
                <nz-option nzValue="proveedor3" nzLabel="Proveedor 3"></nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>

      <div nz-row nzGutter="16">
        <div nz-col nzXs="24" nzSm="12">
          <nz-form-item>
            <nz-form-control [nzValidateStatus]="getFieldStatus('requiresColdChain')"
                             [nzErrorTip]="getFieldError('requiresColdChain')">
              <nz-form-label class="text-[15px] font-semibold text-dark dark:text-white/[.87] capitalize mb-[10px]">
                Requiere cadena de frío: <span class="text-red-500">*</span></nz-form-label>
              <nz-select
                class="w-full"
                nzPlaceHolder="Seleccionar opción" nzAllowClear formControlName="requiresColdChain">
                <nz-option nzValue="si" nzLabel="Sí"></nz-option>
                <nz-option nzValue="no" nzLabel="No"></nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzXs="24" nzSm="12">
          <nz-form-item>
            <nz-form-control [nzValidateStatus]="getFieldStatus('tempMin')" [nzErrorTip]="getFieldError('tempMin')">
              <nz-form-label class="text-[15px] font-semibold text-dark dark:text-white/[.87] capitalize mb-[10px]">
                Rango de temperatura: <span class="text-red-500">*</span></nz-form-label>
              <div class="flex items-center gap-2">
                <input class="{{inputClass}} flex-1" type="number" nz-input placeholder="##°F"
                       formControlName="tempMin">
                <span class="text-dark dark:text-white/[.87]">-</span>
                <input class="{{inputClass}} flex-1" type="number" nz-input placeholder="##°F"
                       formControlName="tempMax">
              </div>
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>

      <nz-form-item>
        <nz-form-control [nzValidateStatus]="getFieldStatus('description')" [nzErrorTip]="getFieldError('description')">
          <nz-form-label class="text-[15px] font-semibold text-dark dark:text-white/[.87] capitalize mb-[10px]">
            Descripción: <span class="text-red-500">*</span></nz-form-label>
          <textarea
            class="w-full min-h-[100px] rounded-[6px] text-[16px] dark:bg-white/10 px-[16px] py-[12px] outline-none"
            nz-input placeholder="Descripción" formControlName="description"></textarea>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-control [nzValidateStatus]="getFieldStatus('storageInstructions')"
                         [nzErrorTip]="getFieldError('storageInstructions')">
          <nz-form-label class="text-[15px] font-semibold text-dark dark:text-white/[.87] capitalize mb-[10px]">
            Instrucciones de almacenamiento: <span class="text-red-500">*</span></nz-form-label>
          <textarea
            class="w-full min-h-[100px] rounded-[6px] text-[16px] dark:bg-white/10 px-[16px] py-[12px] outline-none"
            nz-input placeholder="Instrucciones de almacenamiento" formControlName="storageInstructions"></textarea>
        </nz-form-control>
      </nz-form-item>

      <div nz-row nzGutter="16">
        <div nz-col nzXs="24" nzSm="12">
          <nz-form-item>
            <nz-form-control [nzValidateStatus]="getFieldStatus('warehouse')" [nzErrorTip]="getFieldError('warehouse')">
              <nz-form-label class="text-[15px] font-semibold text-dark dark:text-white/[.87] capitalize mb-[10px]">
                Bodega: <span class="text-red-500">*</span></nz-form-label>
              <nz-select
                class="w-full"
                nzPlaceHolder="Seleccionar bodega" nzAllowClear formControlName="warehouse" [nzLoading]="isLoadingWarehouses">
                <nz-option *ngFor="let warehouse of warehouses" [nzValue]="warehouse.id" [nzLabel]="warehouse.name"></nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzXs="24" nzSm="12">
          <nz-form-item>
            <nz-form-control [nzValidateStatus]="getFieldStatus('quantity')" [nzErrorTip]="getFieldError('quantity')">
              <nz-form-label class="text-[15px] font-semibold text-dark dark:text-white/[.87] capitalize mb-[10px]">
                Cantidad: <span class="text-red-500">*</span></nz-form-label>
              <input class="{{inputClass}}" type="number" nz-input placeholder="Cantidad" formControlName="quantity">
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>

      <nz-form-item class="mb-0">
        <nz-form-control [nzValidateStatus]="getFieldStatus('location')" [nzErrorTip]="getFieldError('location')">
          <nz-form-label class="text-[15px] font-semibold text-dark dark:text-white/[.87] capitalize mb-[10px]">
            Ubicación del producto: <span class="text-red-500">*</span></nz-form-label>
          <input class="{{inputClass}}" type="text" nz-input placeholder="Ubicación del producto" formControlName="location">
        </nz-form-control>
      </nz-form-item>
    </form>
  </ng-template>

  <ng-template #productModalFooter>
    <div class="flex justify-center gap-3 w-full">
      <button class="btn-secondary" (click)="handleProductModalCancel()">
        Cancelar
      </button>
      <button class="btn-primary" (click)="handleProductModalOk()" [nzLoading]="isProductModalLoading">
        <span nz-icon nzType="plus" nzTheme="outline"></span>
        Crear Producto
      </button>
    </div>
  </ng-template>
</nz-modal>

<div class="flex justify-end mb-[25px] mt-[4px]">
  <!-- New Product -->
  <button class="btn-primary" (click)="showProductModal()">
    <span nz-icon nzType="plus" nzTheme="outline"></span>
    Crear producto
  </button>
  <!-- end: New Product -->
</div>

<h1 class="screen-title mb-6">Productos</h1>

<div class="table-container">
  <table>
    <thead>
      <tr>
        <th>Producto</th>
        <th>Precio (Und)</th>
        <th>Proveedor</th>
        <th>Caracteristicas</th>
        <th>Estado</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let data of listOfData">
        <td>{{ data.name }}</td>
        <td>${{ data.price | number:'1.2-2' }}</td>
        <td>{{ data.provider }}</td>
        <td style="max-width: 400px; white-space: normal; word-wrap: break-word;">
          {{ data.storageInstructions || 'N/A' }}
        </td>
        <td>
          <nz-tag [nzColor]="data.status === 'active' ? 'green' : 'default'">
            {{ data.status === 'active' ? 'Activo' : 'Inactivo' }}
          </nz-tag>
        </td>
        <td>
          <button
            (click)="navigateToInventory(data.id)"
            class="inline-flex items-center justify-center w-[44px] h-[44px] rounded-[6px] border-none cursor-pointer transition-all duration-200"
            style="background-color: var(--blue-violet-extralight, #E8ECFF); color: var(--blue-violet-dark, #3749B3);"
            onmouseover="this.style.backgroundColor='var(--blue-violet-dark, #3749B3)'; this.style.color='white';"
            onmouseout="this.style.backgroundColor='var(--blue-violet-extralight, #E8ECFF)'; this.style.color='var(--blue-violet-dark, #3749B3)';">
            <span class="text-[18px]" nz-icon nzType="home" nzTheme="outline"></span>
          </button>
        </td>
      </tr>
    </tbody>
  </table>
</div>
