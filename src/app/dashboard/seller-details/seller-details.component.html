<!-- Header outside container -->
<div class="seller-header">
  <app-back-button (backClick)="goBack()"></app-back-button>
  <h1 class="screen-title">{{ 'sellerDetails.title' | customTranslate }}</h1>
</div>

<!-- Loading State -->
<div *ngIf="loading" class="loading-container">
  <nz-spin nzSimple [nzSize]="'large'"></nz-spin>
  <p>{{ 'sellerDetails.loadingSeller' | customTranslate }}</p>
</div>

<!-- Error State -->
<div *ngIf="!loading && error" class="error-container">
  <span nz-icon nzType="exclamation-circle" nzTheme="outline" class="error-icon"></span>
  <p>{{ error }}</p>
  <button class="btn-primary" (click)="goBack()">{{ 'sellerDetails.backToSellers' | customTranslate }}</button>
</div>

<!-- Content -->
<div *ngIf="!loading && !error && seller" class="seller-detail-container">
  <!-- Subtitle inside white container -->
  <p class="subtitle">{{ 'sellerDetails.subtitle' | customTranslate }}</p>
  
  <!-- Tabs -->
  <app-tabs
    [tabs]="tabs"
    [activeTabId]="activeTab"
    (tabChange)="onTabChange($event)">
  </app-tabs>

  <!-- Tab Content -->
  <div class="tab-content">
      <!-- Información Tab -->
      <div *ngIf="activeTab === 'information'" class="information-tab">
        <!-- Profile Section -->
        <div class="profile-section">
          <div class="profile-card">
            <div class="profile-picture">
              <span nz-icon nzType="user" nzTheme="outline"></span>
            </div>
            
            <h2 class="seller-name">{{ seller.name }}</h2>
            <span class="seller-status" [ngClass]="getStatusColor()">
              {{ getStatusText() }}
            </span>

            <!-- <button class="btn-primary view-clients-btn" (click)="createVisitRoute()">
              Generar ruta de visita
            </button> -->
          </div>
        </div>

        <!-- Details Section -->
        <div class="details-section">
          <!-- Información Personal -->
          <div class="detail-card">
            <h3 class="detail-card-title">
              <span nz-icon nzType="idcard" nzTheme="outline"></span>
              {{ 'sellerDetails.personalInfo.title' | customTranslate }}
            </h3>
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">{{ 'sellerDetails.personalInfo.identification' | customTranslate }}</span>
                <span class="detail-value">{{ seller.identification }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">{{ 'sellerDetails.personalInfo.email' | customTranslate }}</span>
                <span class="detail-value">{{ seller.email }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">{{ 'sellerDetails.personalInfo.phone' | customTranslate }}</span>
                <span class="detail-value">{{ seller.phone }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">{{ 'sellerDetails.personalInfo.address' | customTranslate }}</span>
                <span class="detail-value">{{ seller.address ? seller.address : ('sellerDetails.personalInfo.notSpecified' | customTranslate) }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">{{ 'sellerDetails.personalInfo.entryDate' | customTranslate }}</span>
                <span class="detail-value">{{ seller.entryDate }}</span>
              </div>
            </div>
          </div>

          <!-- Información Comercial -->
          <div class="detail-card">
            <h3 class="detail-card-title">
              <span nz-icon nzType="dollar" nzTheme="outline"></span>
              {{ 'sellerDetails.commercialInfo.title' | customTranslate }}
            </h3>
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">{{ 'sellerDetails.commercialInfo.commission' | customTranslate }}</span>
                <span class="detail-value highlight">{{ seller.commission ? seller.commission + '%' : ('sellerDetails.commercialInfo.notDefined' | customTranslate) }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">{{ 'sellerDetails.commercialInfo.salesTarget' | customTranslate }}</span>
                <span class="detail-value highlight">{{ seller.salesTarget ? formatCurrency(seller.salesTarget) : ('sellerDetails.commercialInfo.notDefined' | customTranslate) }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Desempeño Tab -->
      <div *ngIf="activeTab === 'performance'" class="performance-tab">
        <h2 class="text-lg font-semibold mb-6 text-dark dark:text-white/[.87]">
          {{ 'performance.title' | customTranslate }} {{ seller.name }}
        </h2>

        <!-- Selectores de fecha -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
          <div class="space-y-2">
            <label class="text-sm font-medium text-dark dark:text-white/[.87]">{{ 'performance.startDate' | customTranslate }}</label>
            <nz-date-picker
              [(ngModel)]="performanceData.startDate"
              (ngModelChange)="onStartDateChange($event)"
              nzMode="month"
              nzFormat="MM/yyyy"
              [nzDisabledDate]="disableFutureMonths"
              [nzPlaceHolder]="'performance.selectMonthYear' | customTranslate"
              class="w-full">
            </nz-date-picker>
          </div>
          <div class="space-y-2">
            <label class="text-sm font-medium text-dark dark:text-white/[.87]">{{ 'performance.endDate' | customTranslate }}</label>
            <nz-date-picker
              [(ngModel)]="performanceData.endDate"
              (ngModelChange)="onEndDateChange($event)"
              nzMode="month"
              nzFormat="MM/yyyy"
              [nzDisabledDate]="disableFutureMonths"
              [nzPlaceHolder]="'performance.selectMonthYear' | customTranslate"
              class="w-full">
            </nz-date-picker>
          </div>
        </div>

        <!-- KPIs -->
        <div class="mb-6">
          <h3 class="text-md font-semibold mb-4 text-dark dark:text-white/[.87]">{{ 'performance.kpis' | customTranslate }}</h3>
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
            <!-- Ventas realizadas -->
            <div class="bg-white dark:bg-white/10 rounded-lg p-4 border border-gray-200 dark:border-gray-600 flex flex-col kpi-card">
              <h4 class="text-sm font-medium text-light dark:text-white/60 mb-2">{{ 'performance.salesDone' | customTranslate }}</h4>
              <ng-container *ngIf="!loadingPerformance; else loadingKpi">
                <p class="text-2xl font-bold text-dark dark:text-white/[.87] mt-auto kpi-value">
                  {{ formatCurrency(performanceData.kpis.total_revenue) }}
                </p>
              </ng-container>
              <ng-template #loadingKpi>
                <nz-skeleton class="mt-auto" [nzActive]="true" [nzTitle]="false" [nzParagraph]="{rows: 1, width: '80%'}"></nz-skeleton>
              </ng-template>
            </div>

            <!-- Órdenes generadas -->
            <div class="bg-white dark:bg-white/10 rounded-lg p-4 border border-gray-200 dark:border-gray-600 flex flex-col kpi-card">
              <h4 class="text-sm font-medium text-light dark:text-white/60 mb-2">{{ 'performance.ordersGenerated' | customTranslate }}</h4>
              <ng-container *ngIf="!loadingPerformance; else loadingKpi2">
                <p class="text-2xl font-bold text-dark dark:text-white/[.87] mt-auto kpi-value">{{performanceData.kpis.total_orders}}</p>
              </ng-container>
              <ng-template #loadingKpi2>
                <nz-skeleton class="mt-auto" [nzActive]="true" [nzTitle]="false" [nzParagraph]="{rows: 1, width: '60%'}"></nz-skeleton>
              </ng-template>
            </div>

            <!-- Visitas realizadas -->
            <div class="bg-white dark:bg-white/10 rounded-lg p-4 border border-gray-200 dark:border-gray-600 flex flex-col kpi-card">
              <h4 class="text-sm font-medium text-light dark:text-white/60 mb-2">{{ 'performance.visitsDone' | customTranslate }}</h4>
              <ng-container *ngIf="!loadingPerformance; else loadingKpi3">
                <p class="text-2xl font-bold text-dark dark:text-white/[.87] mt-auto kpi-value">{{performanceData.kpis.total_visits}}</p>
              </ng-container>
              <ng-template #loadingKpi3>
                <nz-skeleton class="mt-auto" [nzActive]="true" [nzTitle]="false" [nzParagraph]="{rows: 1, width: '60%'}"></nz-skeleton>
              </ng-template>
            </div>

            <!-- % cumplimiento unidades -->
            <div class="bg-white dark:bg-white/10 rounded-lg p-4 border border-gray-200 dark:border-gray-600 flex flex-col kpi-card">
              <h4 class="text-sm font-medium text-light dark:text-white/60 mb-2">{{ 'performance.unitsCompliance' | customTranslate }}</h4>
              <ng-container *ngIf="!loadingPerformance; else loadingKpi4">
                <p class="text-2xl font-bold text-dark dark:text-white/[.87] mt-auto kpi-value">{{performanceData.kpis.units_compliance}}%</p>
              </ng-container>
              <ng-template #loadingKpi4>
                <nz-skeleton class="mt-auto" [nzActive]="true" [nzTitle]="false" [nzParagraph]="{rows: 1, width: '70%'}"></nz-skeleton>
              </ng-template>
            </div>

            <!-- % cumplimiento ingresos -->
            <div class="bg-white dark:bg-white/10 rounded-lg p-4 border border-gray-200 dark:border-gray-600 flex flex-col kpi-card">
              <h4 class="text-sm font-medium text-light dark:text-white/60 mb-2">{{ 'performance.revenueCompliance' | customTranslate }}</h4>
              <ng-container *ngIf="!loadingPerformance; else loadingKpi5">
                <p class="text-2xl font-bold text-dark dark:text-white/[.87] mt-auto kpi-value">{{performanceData.kpis.revenue_compliance}}%</p>
              </ng-container>
              <ng-template #loadingKpi5>
                <nz-skeleton class="mt-auto" [nzActive]="true" [nzTitle]="false" [nzParagraph]="{rows: 1, width: '70%'}"></nz-skeleton>
              </ng-template>
            </div>
          </div>
        </div>

        <!-- Productos más vendidos -->
        <div class="mb-6">
          <div class="flex justify-between items-center mb-4">
            <h3 class="text-md font-semibold text-dark dark:text-white/[.87]">{{ 'performance.topProducts' | customTranslate }}</h3>
          </div>
          <div class="bg-white dark:bg-white/10 rounded-lg p-4 border border-gray-200 dark:border-gray-600">
            <ng-container *ngIf="!loadingTopProducts; else loadingTopProductsSkeleton">
              <div class="space-y-3" *ngIf="performanceData.topProducts.length > 0; else noProducts">
                <!-- Header de la tabla -->
                <div class="grid grid-cols-12 gap-4 pb-2 border-b border-gray-200 dark:border-gray-600 mb-2">
                  <div class="col-span-1 text-xs font-semibold text-light dark:text-white/60 text-center">#</div>
                  <div class="col-span-5 text-xs font-semibold text-light dark:text-white/60">{{ 'performance.product' | customTranslate }}</div>
                  <div class="col-span-3 text-xs font-semibold text-light dark:text-white/60 text-right">{{ 'performance.quantity' | customTranslate }}</div>
                  <div class="col-span-3 text-xs font-semibold text-light dark:text-white/60 text-right">{{ 'performance.amount' | customTranslate }}</div>
                </div>
                <!-- Filas de productos -->
                <div *ngFor="let product of performanceData.topProducts; let i = index"
                     class="grid grid-cols-12 gap-4 py-2 border-b border-gray-100 dark:border-gray-600 last:border-b-0 items-center">
                  <div class="col-span-1 flex justify-center">
                    <span class="w-6 h-6 bg-primary/10 text-primary text-xs font-semibold rounded-full flex items-center justify-center">
                      {{i + 1}}
                    </span>
                  </div>
                  <div class="col-span-5">
                    <span class="text-sm text-dark dark:text-white/[.87]">{{product.name}}</span>
                  </div>
                  <div class="col-span-3 text-right">
                    <span class="text-sm text-light dark:text-white/60">{{product.quantity}} {{ 'performance.units' | customTranslate }}</span>
                  </div>
                  <div class="col-span-3 text-right">
                    <span class="text-sm font-medium text-dark dark:text-white/[.87]">{{formatCurrency(product.sales_amount)}}</span>
                  </div>
                </div>
              </div>
              <ng-template #noProducts>
                <div class="text-center py-4 text-light dark:text-white/60">
                  {{ 'performance.noProductsMessage' | customTranslate }}
                </div>
              </ng-template>
            </ng-container>
            <ng-template #loadingTopProductsSkeleton>
              <div class="space-y-3">
                <!-- Header de skeleton -->
                <div class="grid grid-cols-12 gap-4 pb-2 border-b border-gray-200 dark:border-gray-600 mb-2">
                  <div class="col-span-1"></div>
                  <div class="col-span-5"></div>
                  <div class="col-span-3"></div>
                  <div class="col-span-3"></div>
                </div>
                <!-- Skeleton rows -->
                <div *ngFor="let item of [1,2,3,4,5]" class="grid grid-cols-12 gap-4 py-2 border-b border-gray-100 dark:border-gray-600 last:border-b-0">
                  <div class="col-span-1 flex justify-center">
                    <nz-skeleton [nzActive]="true" [nzTitle]="false" [nzParagraph]="{rows: 1, width: '24px'}"></nz-skeleton>
                  </div>
                  <div class="col-span-5">
                    <nz-skeleton [nzActive]="true" [nzTitle]="false" [nzParagraph]="{rows: 1}"></nz-skeleton>
                  </div>
                  <div class="col-span-3">
                    <nz-skeleton [nzActive]="true" [nzTitle]="false" [nzParagraph]="{rows: 1, width: '80%'}"></nz-skeleton>
                  </div>
                  <div class="col-span-3">
                    <nz-skeleton [nzActive]="true" [nzTitle]="false" [nzParagraph]="{rows: 1, width: '70%'}"></nz-skeleton>
                  </div>
                </div>
              </div>
            </ng-template>
          </div>
        </div>

        <!-- Gráfico de productos vendidos -->
        <div class="mb-6">
          <div class="mb-4">
            <h3 class="text-md font-semibold text-dark dark:text-white/[.87]">{{ 'performance.productsChart' | customTranslate }}</h3>
          </div>
          <div class="bg-white dark:bg-white/10 rounded-lg p-4 border border-gray-200 dark:border-gray-600">
            <ng-container *ngIf="!loadingTopProducts; else loadingChartSkeleton">
              <div *ngIf="performanceData.topProducts.length > 0; else noChartData">
                <apx-chart
                  #chart
                  [series]="chartOptions.series"
                  [chart]="chartOptions.chart"
                  [xaxis]="chartOptions.xaxis"
                  [yaxis]="chartOptions.yaxis"
                  [dataLabels]="chartOptions.dataLabels"
                  [tooltip]="chartOptions.tooltip"
                  [colors]="chartOptions.colors"
                  [legend]="chartOptions.legend"
                  [plotOptions]="chartOptions.plotOptions">
                </apx-chart>
              </div>
              <ng-template #noChartData>
                <div class="text-center py-8 text-light dark:text-white/60">
                  <p>{{ 'performance.noChartData' | customTranslate }}</p>
                </div>
              </ng-template>
            </ng-container>
            <ng-template #loadingChartSkeleton>
              <div class="flex items-center justify-center py-8">
                <nz-skeleton [nzActive]="true" [nzTitle]="false" [nzParagraph]="{rows: 8, width: ['100%', '90%', '95%', '85%', '100%', '90%', '95%', '85%']}"></nz-skeleton>
              </div>
            </ng-template>
          </div>
        </div>
      </div>

      <!-- Plan de ventas Tab -->
      <div *ngIf="activeTab === 'sales-plan'" class="sales-plan-tab">
        <!-- Header con título, filtro y botón -->
        <div class="sales-plan-header">
          <h3 class="sales-plan-title">{{ 'sellerDetails.salesPlan.title' | customTranslate }} {{ seller?.name }}</h3>
          <div class="sales-plan-controls-row">
            <div class="filters-group">
              <div class="month-filter">
                <label class="filter-label">{{ 'sellerDetails.salesPlan.monthLabel' | customTranslate }}</label>
                <nz-select
                  class="month-select"
                  [(ngModel)]="selectedMonth"
                  (ngModelChange)="onMonthChange()"
                  [nzPlaceHolder]="'sellerDetails.salesPlan.selectMonth' | customTranslate">
                  <nz-option *ngFor="let month of months" [nzValue]="month.value" [nzLabel]="month.label"></nz-option>
                </nz-select>
              </div>
              <div class="year-filter">
                <label class="filter-label">{{ 'sellerDetails.salesPlan.yearLabel' | customTranslate }}</label>
                <nz-select
                  class="year-select"
                  [(ngModel)]="selectedYear"
                  (ngModelChange)="onYearChange()"
                  [nzPlaceHolder]="'sellerDetails.salesPlan.selectYear' | customTranslate">
                  <nz-option *ngFor="let year of years" [nzValue]="year" [nzLabel]="year.toString()"></nz-option>
                </nz-select>
              </div>
            </div>
            <button class="btn-primary" (click)="onCreatePlan()">
              <span nz-icon nzType="plus" nzTheme="outline"></span>
              {{ 'sellerDetails.salesPlan.createPlan' | customTranslate }}
            </button>
          </div>
        </div>

        <!-- Loading -->
        <div *ngIf="loadingSalesPlans" class="text-center py-8">
          <nz-spin nzSimple [nzSize]="'large'"></nz-spin>
          <p class="mt-4 text-gray-500">{{ 'sellerDetails.salesPlan.loadingPlans' | customTranslate }}</p>
        </div>

        <!-- Sin planes -->
        <div *ngIf="!loadingSalesPlans && salesPlans.length === 0" class="empty-state-wrapper">
          <div class="empty-state">
            <span nz-icon nzType="dollar" nzTheme="outline" class="empty-icon"></span>
            <h3>{{ 'sellerDetails.salesPlan.noPlans' | customTranslate }}</h3>
            <p>{{ 'sellerDetails.salesPlan.noPlansDescription' | customTranslate }}</p>
          </div>
        </div>

        <!-- Tabla de planes de venta -->
        <div *ngIf="!loadingSalesPlans && salesPlans.length > 0"
             class="bg-white dark:bg-white/10 m-0 p-0 text-theme-gray dark:text-white/60 text-[15px] rounded-10 relative mb-[25px]">
          <div class="p-[25px]">
            <div class="w-full overflow-x-auto">
              <nz-table
                #salesPlansTable
                [nzData]="salesPlans"
                [nzFrontPagination]="false"
                [nzShowPagination]="false"
                [nzLoading]="loadingSalesPlans"
                class="pagination-centered">
                <thead>
                  <tr>
                    <th
                      class="bg-regularBG dark:bg-[#323440] px-[20px] py-[16px] text-start text-dark dark:text-white/[.87] text-15px font-medium border-none before:hidden rounded-s-[10px] capitalize">
                      {{ 'sellerDetails.salesPlan.tableHeaders.planName' | customTranslate }}
                    </th>
                    <th
                      class="bg-regularBG dark:bg-[#323440] px-2 py-[16px] text-start text-dark dark:text-white/[.87] text-[15px] font-medium border-none before:hidden capitalize">
                      {{ 'sellerDetails.salesPlan.tableHeaders.totalUnits' | customTranslate }}
                    </th>
                    <th
                      class="bg-regularBG dark:bg-[#323440] px-2 py-[16px] text-start text-dark dark:text-white/[.87] text-[15px] font-medium border-none before:hidden capitalize">
                      {{ 'sellerDetails.salesPlan.tableHeaders.totalValue' | customTranslate }}
                    </th>
                    <th
                      class="bg-regularBG dark:bg-[#323440] px-[20px] py-[16px] text-start text-dark dark:text-white/[.87] text-[15px] font-medium border-none before:hidden rounded-e-[10px] capitalize">
                      {{ 'sellerDetails.salesPlan.tableHeaders.period' | customTranslate }}
                    </th>
                  </tr>
                </thead>
                <tbody>
                  <tr class="group" *ngFor="let plan of salesPlansTable.data">
                    <td
                      class="ltr:pr-4 rtl:pl-4 text-dark dark:text-white/[.87] text-[15px] py-4 before:hidden border-none group-hover:bg-transparent font-medium">
                      {{ plan.name }}
                    </td>
                    <td
                      class="ltr:pr-4 rtl:pl-4 text-dark dark:text-white/[.87] text-[15px] py-4 before:hidden border-none group-hover:bg-transparent">
                      {{ plan.total_units_target | number }}
                    </td>
                    <td
                      class="ltr:pr-4 rtl:pl-4 text-dark dark:text-white/[.87] text-[15px] py-4 before:hidden border-none group-hover:bg-transparent font-medium">
                      {{ formatCurrency(plan.total_value_target) }}
                    </td>
                    <td
                      class="ltr:pr-4 rtl:pl-4 text-dark dark:text-white/[.87] text-[15px] py-4 before:hidden border-none group-hover:bg-transparent">
                      {{ formatPeriod(plan.start_date, plan.end_date) }}
                    </td>
                  </tr>
                </tbody>
              </nz-table>
            </div>
          </div>
        </div>
      </div>

      <!-- Rutas de visita Tab -->
      <div *ngIf="activeTab === 'visit-routes'" class="visit-routes-tab">
        <!-- Header con botón -->
        <div class="visits-header">
          <h3 class="visits-title">{{ 'sellerDetails.visitRoutes.title' | customTranslate }}</h3>
          <button class="btn-primary" (click)="createVisitRoute()">
            <span nz-icon nzType="plus" nzTheme="outline"></span>
            {{ 'sellerDetails.visitRoutes.generateRoute' | customTranslate }}
          </button>
        </div>

        <!-- Loading -->
        <div *ngIf="loadingRoutes" class="text-center py-8">
          <nz-spin nzSimple [nzSize]="'large'"></nz-spin>
          <p class="mt-4 text-gray-500">{{ 'sellerDetails.visitRoutes.loadingRoutes' | customTranslate }}</p>
        </div>

        <!-- Sin rutas -->
        <div *ngIf="!loadingRoutes && visitRoutes.length === 0" class="empty-state text-center py-12">
          <span nz-icon nzType="calendar" nzTheme="outline" class="empty-icon text-6xl mb-4 block text-gray-300"></span>
          <h3 class="text-lg font-semibold text-dark dark:text-white mb-2">{{ 'sellerDetails.visitRoutes.noRoutes' | customTranslate }}</h3>
          <p class="text-gray-500">{{ 'sellerDetails.visitRoutes.noRoutesDescription' | customTranslate }}</p>
        </div>

        <!-- Tabla de rutas -->
        <div *ngIf="!loadingRoutes && visitRoutes.length > 0" class="table-container">
          <table>
            <thead>
              <tr>
                <th>{{ 'sellerDetails.visitRoutes.tableHeaders.id' | customTranslate }}</th>
                <th>{{ 'sellerDetails.visitRoutes.tableHeaders.date' | customTranslate }}</th>
                <th>{{ 'sellerDetails.visitRoutes.tableHeaders.clients' | customTranslate }}</th>
                <th>{{ 'sellerDetails.visitRoutes.tableHeaders.duration' | customTranslate }}</th>
                <th>{{ 'sellerDetails.visitRoutes.tableHeaders.status' | customTranslate }}</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let route of visitRoutes">
                <td>
                  <p class="font-medium">#{{ route.id }}</p>
                </td>
                <td>
                  <p>{{ route.routeDate }}</p>
                </td>
                <td>
                  <p class="font-medium" 
                     [nz-tooltip]="getClientNamesForTooltip(route)"
                     *ngIf="route.stops && route.stops.length > 0">
                    {{ getClientNamesShort(route) }}
                  </p>
                  <p class="font-medium" *ngIf="!route.stops || route.stops.length === 0">
                    {{ route.totalClients }} {{ 'sellerDetails.visitRoutes.clients' | customTranslate }}
                  </p>
                </td>
                <td>
                  <p>{{ route.estimatedDurationMinutes ? (route.estimatedDurationMinutes + ' ' + ('sellerDetails.visitRoutes.minutes' | customTranslate)) : '--' }}</p>
                </td>
                <td>
                  <nz-tag [nzColor]="getRouteStatusColor(route.status)">
                    {{ getRouteStatusText(route.status) }}
                  </nz-tag>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
  </div>
</div>

<!-- Modal de crear plan de ventas -->
<nz-modal
  [(nzVisible)]="isSalesPlanModalVisible"
  [nzTitle]="salesPlanModalTitle"
  [nzContent]="salesPlanModalContent"
  [nzFooter]="salesPlanModalFooter"
  (nzOnCancel)="handleSalesPlanModalCancel()"
  nzWidth="75%"
>
  <ng-template #salesPlanModalTitle>{{ 'sellerDetails.salesPlan.modal.title' | customTranslate }}</ng-template>

  <ng-template #salesPlanModalContent>
    <form nz-form nzLayout="vertical" [formGroup]="salesPlanForm" (ngSubmit)="handleSalesPlanModalOk()">
      <nz-form-item>
        <nz-form-control [nzValidateStatus]="getFieldStatus('name')" [nzErrorTip]="getFieldError('name')">
          <nz-form-label class="text-[15px] font-semibold text-dark dark:text-white/[.87] capitalize mb-[10px]">
            {{ 'sellerDetails.salesPlan.modal.planName' | customTranslate }} <span class="text-red-500">*</span>
          </nz-form-label>
          <input 
            class="w-full rounded-[6px] text-[16px] dark:bg-white/10 px-[16px] py-[12px] min-h-[50px] outline-none" 
            type="text" 
            nz-input 
            [placeholder]="'sellerDetails.salesPlan.modal.planNamePlaceholder' | customTranslate" 
            formControlName="name">
        </nz-form-control>
      </nz-form-item>

      <div nz-row nzGutter="16">
        <div nz-col nzXs="24" nzSm="12">
          <nz-form-item>
            <nz-form-control [nzValidateStatus]="getFieldStatus('start_month')" [nzErrorTip]="getFieldError('start_month')">
              <nz-form-label class="text-[15px] font-semibold text-dark dark:text-white/[.87] capitalize mb-[10px]">
                {{ 'sellerDetails.salesPlan.modal.startMonth' | customTranslate }} <span class="text-red-500">*</span>
              </nz-form-label>
              <nz-date-picker
                [formControl]="salesPlanForm.get('start_month')"
                nzMode="month"
                nzFormat="yyyy-MM"
                [nzPlaceHolder]="'sellerDetails.salesPlan.modal.selectMonthYear' | customTranslate"
                [nzDisabledDate]="disableFutureMonthsForSalesPlan"
                class="w-full">
              </nz-date-picker>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzXs="24" nzSm="12">
          <nz-form-item>
            <nz-form-control [nzValidateStatus]="getFieldStatus('end_month')" [nzErrorTip]="getFieldError('end_month')">
              <nz-form-label class="text-[15px] font-semibold text-dark dark:text-white/[.87] capitalize mb-[10px]">
                {{ 'sellerDetails.salesPlan.modal.endMonth' | customTranslate }} <span class="text-red-500">*</span>
              </nz-form-label>
              <nz-date-picker
                [formControl]="salesPlanForm.get('end_month')"
                nzMode="month"
                nzFormat="yyyy-MM"
                [nzPlaceHolder]="'sellerDetails.salesPlan.modal.selectMonthYear' | customTranslate"
                [nzDisabledDate]="disableFutureMonthsForSalesPlan"
                class="w-full">
              </nz-date-picker>
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>

      <div nz-row nzGutter="16">
        <div nz-col nzXs="24" nzSm="12">
          <nz-form-item>
            <nz-form-control [nzValidateStatus]="getFieldStatus('total_units_target')" [nzErrorTip]="getFieldError('total_units_target')">
              <nz-form-label class="text-[15px] font-semibold text-dark dark:text-white/[.87] capitalize mb-[10px]">
                {{ 'sellerDetails.salesPlan.modal.totalUnits' | customTranslate }} <span class="text-red-500">*</span>
              </nz-form-label>
              <input 
                class="w-full rounded-[6px] text-[16px] dark:bg-white/10 px-[16px] py-[12px] min-h-[50px] outline-none" 
                type="number" 
                nz-input 
                [placeholder]="'sellerDetails.salesPlan.modal.totalUnitsPlaceholder' | customTranslate" 
                formControlName="total_units_target"
                min="1">
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzXs="24" nzSm="12">
          <nz-form-item>
            <nz-form-control [nzValidateStatus]="getFieldStatus('total_value_target')" [nzErrorTip]="getFieldError('total_value_target')">
              <nz-form-label class="text-[15px] font-semibold text-dark dark:text-white/[.87] capitalize mb-[10px]">
                {{ 'sellerDetails.salesPlan.modal.totalValue' | customTranslate }} <span class="text-red-500">*</span>
              </nz-form-label>
              <input 
                class="w-full rounded-[6px] text-[16px] dark:bg-white/10 px-[16px] py-[12px] min-h-[50px] outline-none" 
                type="number" 
                nz-input 
                [placeholder]="'sellerDetails.salesPlan.modal.totalValuePlaceholder' | customTranslate" 
                formControlName="total_value_target"
                step="0.01"
                min="0.01">
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>

      <nz-form-item>
        <nz-form-control [nzValidateStatus]="getFieldStatus('visits_target')" [nzErrorTip]="getFieldError('visits_target')">
          <nz-form-label class="text-[15px] font-semibold text-dark dark:text-white/[.87] capitalize mb-[10px]">
            {{ 'sellerDetails.salesPlan.modal.visitsTarget' | customTranslate }} <span class="text-red-500">*</span>
          </nz-form-label>
          <input 
            class="w-full rounded-[6px] text-[16px] dark:bg-white/10 px-[16px] py-[12px] min-h-[50px] outline-none" 
            type="number" 
            nz-input 
            [placeholder]="'sellerDetails.salesPlan.modal.visitsTargetPlaceholder' | customTranslate" 
            formControlName="visits_target"
            min="1">
        </nz-form-control>
      </nz-form-item>
    </form>
  </ng-template>

  <ng-template #salesPlanModalFooter>
    <div class="flex justify-center gap-3 w-full">
      <button class="btn-secondary-sm" (click)="handleSalesPlanModalCancel()">{{ 'sellerDetails.salesPlan.modal.cancel' | customTranslate }}</button>
      <button class="btn-primary-sm" (click)="handleSalesPlanModalOk()" [nzLoading]="isSalesPlanModalLoading">
        <span nz-icon nzType="plus" nzTheme="outline"></span>
        {{ 'sellerDetails.salesPlan.modal.create' | customTranslate }}
      </button>
    </div>
  </ng-template>
</nz-modal>

